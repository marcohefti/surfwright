{"id":"A5-001","severity":"high","category":"hot_path/session_scaling","file":"src/core/session/public.ts","line":114,"problem":"sessionEnsure always runs global sessionPrune, forcing serial reachability probes across all sessions before normal ensure/open flows.","evidence":"session/public.ts:104,112,114; maintenance.ts:163; maintenance-session-prune.ts:132,134,137,145,149","recommendation":"Remove mandatory global prune from sessionEnsure; health-check only target session inline and move full prune to bounded background maintenance.","risk_if_ignored":"Command latency and timeout risk increase linearly with session count and unreachable endpoints.","effort":"M"}
{"id":"A5-002","severity":"high","category":"state_growth/contention","file":"src/core/state/infra/state-store.ts","line":309,"problem":"Each state mutation acquires one global file lock and performs full-state read/normalize plus full JSON rewrite.","evidence":"state-store.ts:200-258,280,300-303,309-314","recommendation":"Shard state by domain/session or adopt append-log + compaction; reduce lock scope and avoid full pretty serialization on hot writes.","risk_if_ignored":"Write amplification and lock contention will degrade throughput and can trigger E_STATE_LOCK_TIMEOUT under parallel load.","effort":"L"}
{"id":"A5-003","severity":"high","category":"hot_path","file":"src/core/target/infra/targets.ts","line":297,"problem":"resolveTargetHandle rebuilds target mapping by scanning all contexts/pages and issuing per-page CDP target-info calls.","evidence":"targets.ts:252-257,281-287,297-305; target-network.ts:112","recommendation":"Introduce per-session targetId cache with lifecycle invalidation and fallback full scan only on cache miss.","risk_if_ignored":"Per-action latency scales with open page count and adds unnecessary CDP overhead.","effort":"M"}
{"id":"A5-004","severity":"high","category":"hot_path/write_amplification","file":"src/core/target/infra/targets.ts","line":396,"problem":"targetList persists snapshots with sequential await saveTargetSnapshot calls, causing one state mutation per target.","evidence":"targets.ts:396-406; target-repo.ts:27-28; state-store.ts:393-407,309","recommendation":"Batch snapshot persistence in a single mutateState transaction.","risk_if_ignored":"target list cost grows with (targets x state size), worsening wall time and lock pressure.","effort":"S-M"}
{"id":"A5-005","severity":"medium-high","category":"daemon_scaling_limits/retries","file":"src/core/daemon/domain/lane-scheduler.ts","line":3,"problem":"Daemon queue limits are strict (8 lanes, depth 8, 2s wait) and client retries queue pressure only twice with short delay.","evidence":"lane-scheduler.ts:3-5,159-165,173-187; daemon.ts:15-17,399-415","recommendation":"Implement adaptive queue/backpressure policy and jittered retry strategy driven by queue-wait telemetry.","risk_if_ignored":"Parallel bursts will produce avoidable queue timeout/saturation failures before work runs.","effort":"M"}
{"id":"A5-006","severity":"medium-high","category":"state_growth/hot_path","file":"src/core/target/infra/network/target-network-capture.ts","line":351,"problem":"Network captures are finalized but not deleted on normal end, while default source lookup scans all captures/artifacts with fs existence checks.","evidence":"network-capture-repo.ts:19-38,74-77; target-network-capture.ts:351-355,210,224; target-network-source.ts:301-304,316-319; network/manifest.ts:34-56","recommendation":"Add bounded capture-state retention and stale-path compaction; maintain indexed latest source pointers to avoid full scans.","risk_if_ignored":"State/map growth increases scan latency and filesystem overhead for network-query/trace flows.","effort":"M"}
{"id":"A5-007","severity":"medium","category":"benchmark_discipline","file":"scripts/perf-budget-check.mjs","line":44,"problem":"perf:check validates committed fixture timing fields instead of executing live command paths during the gate.","evidence":"package.json:25,39; perf-budget-check.mjs:44-47,57-74; test/fixtures/perf/budgets.json:3-7","recommendation":"Add executable performance checks (cold/warm, percentile-based) and broaden budget case coverage for critical command families.","risk_if_ignored":"Real runtime regressions can pass CI when fixture timing data is stale or unrepresentative.","effort":"M"}
{"id":"A5-008","severity":"high","category":"runtime_overhead/daemon_scaling_limits","file":"src/core/request-context.ts","line":125,"problem":"Daemon execution path captures stdout/stderr unbounded in memory and only enforces the 4MB response-frame cap at transport stage.","evidence":"request-context.ts:59,69,125-127,138-139; run-orchestrator.ts:21,49-50; worker.ts:240; daemon-transport.ts:3,96-97,140-147","recommendation":"Add bounded output envelopes with deterministic truncation before aggregation, and chunk/stream large daemon responses.","risk_if_ignored":"Large command outputs can cause memory amplification and oversized-frame failures instead of predictable bounded behavior.","effort":"M"}
{"id":"A5-009","severity":"medium","category":"daemon_scaling_limits/hot_path","file":"src/core/daemon/domain/lane-scheduler.ts","line":82,"problem":"Scheduler repeatedly allocates/scans lane key arrays to find runnable lanes each scheduling cycle.","evidence":"lane-scheduler.ts:50,82-97,106-138,187","recommendation":"Track runnable lanes in an incremental queue/ring to avoid full key-array scans on each dispatch.","risk_if_ignored":"Control-plane scheduling overhead increases with lane count and can inflate queue wait under high fan-out.","effort":"M"}
{"id":"A5-010","severity":"medium","category":"state_growth/runtime_overhead","file":"src/core/browser/infra/cdp-endpoint.ts","line":9,"problem":"Process-level CDP reachability cache has no bounded eviction strategy; TTL only affects freshness checks.","evidence":"cdp-endpoint.ts:9,205-207,211,217,222,224","recommendation":"Use bounded TTL+LRU eviction and opportunistic cleanup hooks (e.g., during session prune/clear).","risk_if_ignored":"Long-lived daemons accumulate stale cache entries across many unique CDP origins.","effort":"S-M"}
